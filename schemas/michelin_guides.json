{
  "name": "MichelinGuideEntries",
  "schema_version": "1.0",
  "type": "json_schema",
  "strict": true,
  "schema": {
    "type": "object",
    "properties": {
      "contains_no_content_of_requested_type": {
        "type": "boolean",
        "description": "True, wenn der Input keine Michelin-relevanten Einträge enthält; sonst false."
      },
      "entries": {
        "type": "array",
        "description": "Liste von Etablissements (Restaurants; optional Hotels) mit ihren jahresbezogenen Guide-Einträgen.",
        "items": {
          "type": "object",
          "properties": {
            "estab_name_raw": {
              "type": "string",
              "description": "Name wie gedruckt/online dargestellt."
            },
            "estab_name_norm": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ],
              "description": "Bereinigter, kanonischer Name (für ID-Bildung)."
            },
            "estab_id": {
              "type": "string",
              "description": "Persistente ID über Jahre (z. B. Hash aus Name+Adresse+Ort)."
            },
            "estab_type": {
              "anyOf": [
                { "type": "string", "enum": ["Restaurant", "Hotel", "Other"] },
                { "type": "null" }
              ],
              "description": "Haupttyp laut Guide (historisch: Hotels im roten Band)."
            },
            "address_raw": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ]
            },
            "postal_code": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ]
            },
            "city_raw": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ]
            },
            "city_norm": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ]
            },
            "admin_unit_1": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ],
              "description": "Bundesland/Region/Departement o. ä."
            },
            "admin_unit_2": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ]
            },
            "country_iso": {
              "type": "string",
              "description": "ISO-3166-ALPHA-2/3 oder ALPHA-2 bevorzugt."
            },
            "latitude": {
              "anyOf": [
                { "type": "number" },
                { "type": "null" }
              ]
            },
            "longitude": {
              "anyOf": [
                { "type": "number" },
                { "type": "null" }
              ]
            },
            "web_url": {
              "anyOf": [
                { "type": "string" },
                { "type": "null" }
              ],
              "description": "URL des Betriebs (falls im Guide verlinkt)."
            },
            "cuisine_tags": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Küchenlabels gemäß Guide; Mehrfachnennungen erlaubt."
            },
            "edition_info": {
              "type": "array",
              "description": "Jahresweise Informationen zum Etablissement im jeweiligen Länderguide.",
              "items": {
                "type": "object",
                "properties": {
                  "edition_year": {
                    "type": "integer",
                    "description": "Jahr der betreffenden Guide-Edition."
                  },
                  "guide_id": {
                    "type": "string",
                    "description": "Kanonischer Code, z. B. 'FR', 'DE', 'GBIE', 'ESPT', 'IT', 'CH', 'BE-LU', 'NL', 'NORDIC', 'AT'."
                  },
                  "coverage_scope": {
                    "anyOf": [
                      {
                        "type": "string",
                        "enum": [
                          "Country",
                          "Region",
                          "City",
                          "Other"
                        ]
                      },
                      { "type": "null" }
                    ],
                    "description": "Abdeckungslogik der Edition (Land/Region/Stadt)."
                  },
                  "language": {
                    "anyOf": [
                      {
                        "type": "string",
                        "enum": [
                          "German",
                          "French",
                          "Italian",
                          "Spanish",
                          "English",
                          "Dutch",
                          "Portuguese",
                          "Danish",
                          "Swedish",
                          "Norwegian",
                          "Finnish",
                          "Icelandic",
                          "Unknown",
                          "Other"
                        ]
                      },
                      { "type": "null" }
                    ]
                  },
                  "distinction": {
                    "anyOf": [
                      {
                        "type": "string",
                        "enum": [
                          "Selected",
                          "BibGourmand",
                          "GreenStar",
                          "1Star",
                          "2Stars",
                          "3Stars"
                        ]
                      },
                      { "type": "null" }
                    ],
                    "description": "Höchste verliehene Auszeichnung in dieser Edition (Kombinationen durch Flags unten erfassen)."
                  },
                  "is_bib_gourmand": {
                    "anyOf": [
                      { "type": "boolean" },
                      { "type": "null" }
                    ]
                  },
                  "is_green_star": {
                    "anyOf": [
                      { "type": "boolean" },
                      { "type": "null" }
                    ]
                  },
                  "stars_numeric": {
                    "anyOf": [
                      { "type": "integer" },
                      { "type": "null" }
                    ],
                    "description": "0; 1; 2; 3 – ausschließlich Küchenleistung."
                  },
                  "fork_spoon": {
                    "anyOf": [
                      { "type": "integer" },
                      { "type": "null" }
                    ],
                    "description": "Komfort-/Ambience-Grad (1–5)."
                  },
                  "price_band_raw": {
                    "anyOf": [
                      { "type": "string" },
                      { "type": "null" }
                    ],
                    "description": "Preisband wie im Guide (z. B. €, €€, €€€)."
                  },
                  "price_range_norm": {
                    "anyOf": [
                      {
                        "type": "object",
                        "properties": {
                          "currency_iso": {
                            "anyOf": [
                              { "type": "string" },
                              { "type": "null" }
                            ]
                          },
                          "low_nominal": {
                            "anyOf": [
                              { "type": "number" },
                              { "type": "null" }
                            ]
                          },
                          "high_nominal": {
                            "anyOf": [
                              { "type": "number" },
                              { "type": "null" }
                            ]
                          },
                          "year_price_base": {
                            "anyOf": [
                              { "type": "integer" },
                              { "type": "null" }
                            ],
                            "description": "Basisjahr der Nominalangabe (meist = edition_year)."
                          },
                          "low_real": {
                            "anyOf": [
                              { "type": "number" },
                              { "type": "null" }
                            ],
                            "description": "Reale Preise (CPI-deflationiert)."
                          },
                          "high_real": {
                            "anyOf": [
                              { "type": "number" },
                              { "type": "null" }
                            ]
                          },
                          "ppp_adjusted": {
                            "anyOf": [
                              { "type": "boolean" },
                              { "type": "null" }
                            ],
                            "description": "True, wenn PPP-Korrektur angewendet."
                          }
                        },
                        "required": [
                          "currency_iso",
                          "low_nominal",
                          "high_nominal",
                          "year_price_base",
                          "low_real",
                          "high_real",
                          "ppp_adjusted"
                        ],
                        "additionalProperties": false
                      },
                      { "type": "null" }
                    ],
                    "description": "Normalisierte Preisangaben (für Ländervergleiche und Zeitreihen)."
                  },
                  "inspector_note_short": {
                    "anyOf": [
                      { "type": "string" },
                      { "type": "null" }
                    ]
                  },
                  "ancillary_symbols": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Weitere Piktogramme (z. B. Terrasse, besondere Weinkarte)."
                  },
                  "symbol_legend_version": {
                    "anyOf": [
                      { "type": "string" },
                      { "type": "null" }
                    ],
                    "description": "Edition-spezifische Legendenversion (z. B. Hash/ID eines Legendenschnappschusses)."
                  },
                  "booking_json": {
                    "anyOf": [
                      { "type": "string" },
                      { "type": "null" }
                    ],
                    "description": "Serialisierte Buchungsinfos/Links, falls vorhanden."
                  },
                  "status_change": {
                    "anyOf": [
                      {
                        "type": "string",
                        "enum": [
                          "new",
                          "unchanged",
                          "promoted",
                          "demoted",
                          "deleted"
                        ]
                      },
                      { "type": "null" }
                    ]
                  },
                  "events": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "event_type": {
                          "type": "string",
                          "enum": [
                            "first_listed",
                            "first_star",
                            "promoted",
                            "demoted",
                            "dropped",
                            "reopened",
                            "rebranded",
                            "other"
                          ]
                        },
                        "old_distinction": {
                          "anyOf": [
                            { "type": "string" },
                            { "type": "null" }
                          ]
                        },
                        "new_distinction": {
                          "anyOf": [
                            { "type": "string" },
                            { "type": "null" }
                          ]
                        },
                        "note": {
                          "anyOf": [
                            { "type": "string" },
                            { "type": "null" }
                          ]
                        }
                      },
                      "required": [
                        "event_type",
                        "old_distinction",
                        "new_distinction",
                        "note"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "provenance": {
                    "anyOf": [
                      {
                        "type": "object",
                        "properties": {
                          "source_type": {
                            "type": "string",
                            "enum": [
                              "print",
                              "web",
                              "app",
                              "other"
                            ]
                          },
                          "page_or_url": {
                            "anyOf": [
                              { "type": "string" },
                              { "type": "null" }
                            ]
                          },
                          "ocr_confidence": {
                            "anyOf": [
                              { "type": "number" },
                              { "type": "null" }
                            ]
                          },
                          "extraction_method": {
                            "anyOf": [
                              { "type": "string" },
                              { "type": "null" }
                            ]
                          }
                        },
                        "required": [
                          "source_type",
                          "page_or_url",
                          "ocr_confidence",
                          "extraction_method"
                        ],
                        "additionalProperties": false
                      },
                      { "type": "null" }
                    ],
                    "description": "Beleg- und Qualitätsinformationen zur Extraktion."
                  },
                  "hotel_key_rating": {
                    "anyOf": [
                      { "type": "integer" },
                      { "type": "null" }
                    ],
                    "description": "Nur falls Hotels integriert werden (1–3 Keys; digitales System)."
                  }
                },
                "required": [
                  "edition_year",
                  "guide_id",
                  "coverage_scope",
                  "language",
                  "distinction",
                  "is_bib_gourmand",
                  "is_green_star",
                  "stars_numeric",
                  "fork_spoon",
                  "price_band_raw",
                  "price_range_norm",
                  "inspector_note_short",
                  "ancillary_symbols",
                  "symbol_legend_version",
                  "booking_json",
                  "status_change",
                  "events",
                  "provenance",
                  "hotel_key_rating"
                ],
                "additionalProperties": false
              }
            }
          },
          "required": [
            "estab_name_raw",
            "estab_name_norm",
            "estab_id",
            "estab_type",
            "address_raw",
            "postal_code",
            "city_raw",
            "city_norm",
            "admin_unit_1",
            "admin_unit_2",
            "country_iso",
            "latitude",
            "longitude",
            "web_url",
            "cuisine_tags",
            "edition_info"
          ],
          "additionalProperties": false
        }
      }
    },
    "required": [
      "contains_no_content_of_requested_type",
      "entries"
    ],
    "additionalProperties": false
  }
}
